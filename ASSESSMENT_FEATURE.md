# AI-Powered Knowledge Assessment and Personalized Learning Path

## Overview

This feature implements an AI-powered knowledge assessment system that creates personalized learning curricula for each user based on their preferences, knowledge level, and performance.

## How It Works

### 1. Initial Assessment Flow

When a user enrolls in a new course from the Popular Courses page:

1. **Assessment Dialog Opens**: A dialog appears with 5 diagnostic questions
   - **Q1-2**: Learning preferences (study method and self-assessed knowledge level)
   - **Q3-5**: Course-specific conceptual questions generated by AI

2. **AI Generates Questions**: The system calls Ollama to generate relevant questions based on the course topic

3. **User Answers**: User selects answers for all questions

4. **AI Evaluates**: The system:
   - Extracts learning preferences (study method, knowledge level)
   - Scores conceptual questions (Q3-5)
   - Identifies weak areas from incorrect answers

5. **Personalized Roadmap Created**: Based on evaluation:
   - Topic 1 is always a common introduction
   - Remaining topics adapt to the user's knowledge level
   - Additional reinforcement topics added for weak areas
   - 5-8 topics total in the personalized curriculum

6. **Enrollment Complete**: User is enrolled with their personalized roadmap and redirected to the course

### 2. Learning Progress Flow

As the user progresses through topics:

1. **Topic Content Generation**: AI generates educational content tailored to the user's study method
2. **Topic Quiz**: After studying, user takes a 5-question quiz on the topic
3. **Dynamic Roadmap Refinement**: Based on quiz performance:
   - Weak areas are identified
   - Remaining roadmap is refined to address gaps
   - Additional reinforcement topics can be added

## Technical Implementation

### Backend Components

#### 1. Assessment Service (`server/api/services/assessment_service.py`)

Core service that handles all AI interactions:

- **`generate_initial_mcq(course_name)`**: Generates initial diagnostic questions
- **`evaluate_initial_assessment(questions, answers)`**: Evaluates answers and extracts learning profile
- **`generate_personalized_roadmap(course_name, evaluation)`**: Creates personalized topic sequence
- **`generate_topic_content(course, topic, study_method)`**: Generates educational content
- **`generate_topic_quiz(topic_name, content)`**: Creates quiz from content
- **`evaluate_topic_quiz(quiz, answers)`**: Scores quiz and identifies weak areas
- **`refine_roadmap(course, remaining_topics, weak_areas)`**: Dynamically adjusts roadmap

#### 2. API Endpoints (`server/api/views.py`)

- **`POST /api/assessment/initial/`**: Generate initial assessment questions
  ```json
  {
    "course_id": 1,
    "course_name": "Web Development"
  }
  ```

- **`POST /api/assessment/evaluate/`**: Evaluate assessment and create enrollment
  ```json
  {
    "course_id": 1,
    "course_name": "Web Development",
    "questions": [...],
    "answers": ["Reading", "Beginner", "A", "B", "C"]
  }
  ```

- **`POST /api/assessment/topic/content/`**: Generate topic content
- **`POST /api/assessment/topic/quiz/`**: Generate topic quiz
- **`POST /api/assessment/topic/evaluate/`**: Evaluate quiz and refine roadmap

### Frontend Components

#### 1. AssessmentDialog (`frontend/src/app/components/AssessmentDialog.tsx`)

Modal component that handles the initial assessment flow:

- **Steps**:
  - Loading: Generates questions
  - Questions: User answers
  - Submitting: Evaluates answers
  - Complete: Shows results and roadmap

- **Props**:
  - `courseId`: ID of the course
  - `courseName`: Name of the course
  - `onEnrollmentComplete`: Callback when enrollment is created

#### 2. PopularCoursesPage Integration

Updated to include:
- "Enroll Now" button that triggers assessment dialog
- Course card redesign with enrollment actions
- Assessment dialog integration

### Database Models

The system uses existing models:

- **Enrollment**: Stores `diagnosed_level` and `learning_style_override`
- **LearningRoadmap**: Stores the personalized roadmap JSON
- **Module**: Generated from roadmap topics
- **QuizAttempt**: Records quiz performance
- **ModuleProgress**: Tracks completion status

## AI Integration

### Ollama Configuration

The system uses Ollama for all AI generation tasks. Configuration in `settings.py`:

```python
OLLAMA_API_URL = 'http://localhost:11434/api/chat'
OLLAMA_MODEL = 'phi3:mini'  # or 'llama3:8b-instruct-q4_K_M'
```

### Prompt Engineering

Each AI generation task uses carefully crafted prompts:

1. **Initial Assessment**: Structured to generate preference + knowledge questions
2. **Evaluation**: Extracts preferences and identifies weak areas
3. **Roadmap Generation**: Creates adaptive learning sequence
4. **Content Generation**: Tailored to study method preferences  
5. **Quiz Generation**: Based on actual content, not generic
6. **Roadmap Refinement**: Addresses performance gaps dynamically

## User Experience Flow

```
User clicks "Enroll Now"
    ↓
AI generates diagnostic questions (5 questions)
    ↓
User answers questions
    ↓
AI evaluates: study_method, knowledge_level, score, weak_areas
    ↓
AI creates personalized roadmap (5-8 topics)
    ↓
Enrollment created with custom curriculum
    ↓
User proceeds through topics:
    - Study AI-generated content
    - Take topic quiz
    - Roadmap adapts based on performance
```

## Future Enhancements

1. **Multi-modal Content**: Generate videos, mind maps, and other formats based on learning style
2. **Adaptive Difficulty**: Dynamically adjust question difficulty based on performance
3. **Learning Analytics**: Track learning patterns and optimize recommendations
4. **Collaborative Filtering**: Use data from similar learners to improve recommendations
5. **Spaced Repetition**: Incorporate spaced repetition for better retention
6. **Progress Prediction**: Predict completion time based on user's pace

## Usage Example

### For Users

1. Browse courses in Popular Courses page
2. Click "Enroll Now" on any course
3. Answer 5 diagnostic questions
4. Receive personalized learning roadmap
5. Study topics with AI-generated content
6. Complete quizzes after each topic
7. Roadmap adapts as you progress

### For Developers

#### Generate Initial Assessment

```python
from api.services.assessment_service import get_assessment_service

service = get_assessment_service()
questions = service.generate_initial_mcq("Python Programming")
```

#### Evaluate and Create Roadmap

```python
evaluation = service.evaluate_initial_assessment(questions, user_answers)
roadmap = service.generate_personalized_roadmap("Python Programming", evaluation)
```

#### Generate Topic Content

```python
content = service.generate_topic_content(
    "Python Programming",
    "Variables and Data Types",
    "reading"
)
```

## Testing

### Backend Testing

```bash
cd server
python manage.py test api.tests.test_assessment
```

### Frontend Testing

```bash
cd frontend
npm test
```

### Manual Testing

1. Start Ollama: `ollama serve`
2. Pull model: `ollama pull phi3:mini`
3. Start backend: `python manage.py runserver`
4. Start frontend: `npm run dev`
5. Navigate to Popular Courses
6. Try enrolling in a course

## Troubleshooting

### Common Issues

1. **Ollama not running**: Ensure Ollama service is running on port 11434
2. **Model not found**: Pull the model with `ollama pull phi3:mini`
3. **Slow responses**: Use a smaller model or GPU acceleration
4. **JSON parsing errors**: AI might return malformed JSON; retry or improve prompt
5. **Assessment not loading**: Check browser console and Django logs

## Configuration

### Environment Variables

```env
# Backend
OLLAMA_API_URL=http://localhost:11434/api/chat
OLLAMA_MODEL=phi3:mini

# Frontend
VITE_API_URL=http://localhost:8000/api
```

## Performance Considerations

- **AI Response Time**: 3-10 seconds per generation
- **Caching**: Consider caching generated content
- **Batch Processing**: Generate multiple topics in background
- **Model Selection**: Balance between quality and speed

## Security

- **Authentication**: All endpoints require authentication
- **Enrollment Validation**: Prevents duplicate enrollments
- **Input Sanitization**: Validates all AI-generated content
- **Rate Limiting**: Consider adding rate limits for AI generation

## License

This feature is part of the AI-Powered Learning Platform project.
